﻿function loadWeiXinShareConfig(a){a&&0!=a.appid.length&&(console&&console.log("\u5fae\u4fe1\u5206\u4eab\u56de\u8c03\u6210\u529f\u3002\u3002\u3002\u3002",a),$.getScript("https://res.wx.qq.com/open/js/jweixin-1.3.2.js").done(function(){wx.config({debug:!1,appId:a.appid,timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:"onMenuShareAppMessage onMenuShareTimeline onMenuShareQQ onMenuShareWeibo onMenuShareQZone invokeMiniProgramAPI".split(" ")});wx.ready(function(){wx.onMenuShareAppMessage({title:a.title,desc:a.desc,link:a.url,imgUrl:a.msgImg,success:function(a){},cancel:function(a){},fail:function(a){alert(JSON.stringify(a))}});wx.onMenuShareTimeline({title:a.title,link:a.url,imgUrl:a.msgImg,success:function(){},cancel:function(){}});wx.onMenuShareQQ({title:a.title,desc:a.desc,link:a.url,imgUrl:a.msgImg,success:function(){},cancel:function(){}});wx.onMenuShareWeibo({title:a.title,desc:a.desc,link:a.url,imgUrl:a.msgImg,success:function(){},cancel:function(){}});wx.onMenuShareQZone({title:a.title,desc:a.desc,link:a.url,imgUrl:a.msgImg,success:function(){},cancel:function(){}})})}))}function callback(a){loadWeiXinShareConfig(a)}$(function(){0>window.navigator.userAgent.toLowerCase().indexOf("micromessenger")||(console&&console.log("\u521d\u59cb\u5316\u5fae\u4fe1\u5206\u4eab\u3002\u3002\u3002\u3002"),setTimeout(function(){var a=window.location.href,c="";try{c=$("#ea_l img").attr("src").split("?")[0]}catch(d){try{c=$(".xg_logo img").eq(0).attr("src").split("?")[0]}catch(e){try{c=$("img").eq(0).attr("src").split("?")[0]}catch(f){c="/Images/logo.png"}}}var b=$("meta[name\x3d'description']").attr("content");35<b.length&&(b=b.substring(0,35)+"...");$("body img").each(function(a,b){if(300<$(b).width()&&1E3>$(b).width()&&300<$(b).height()&&1E3>$(b).height())return c=$(b).attr("src"),!1});/(https|http)?:\/\//.test(c)||(c=location.protocol+"//"+location.hostname+c);0==b.length&&(b=document.title);$.ajax({type:"POST",url:"/Admin/WxShare/ShareWeiXin.ashx",dataType:"jsonp",data:{title:document.title,desc:b,msgImg:c,url:a},jsonp:"callback",timeout:3E3})},2E3))});