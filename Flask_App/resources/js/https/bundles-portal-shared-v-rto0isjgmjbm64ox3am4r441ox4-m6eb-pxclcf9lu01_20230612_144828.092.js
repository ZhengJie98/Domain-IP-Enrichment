var shared=angular.module("portalShared",[]);shared.factory("CookieService",[function(){var n=function(n,t,i){var r=new Date;r.setTime(r.getTime()+i);document.cookie=n+"="+t+";path=/;expires="+r.toGMTString()};return{getCookie:function(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return null},setCookie:function(t,i,r){var u=864e5*r;n(t,i,u)},setCookieMinute:function(t,i,r){var u=6e4*r;n(t,i,u)},deleteCookie:function(t){n(t,"",-1)}}}]);shared.factory("CustomModalService",["$modal","$timeout","labelService",function(n,t,i){function r(){function u(n){var t='<div class="cms-modal-header"><h4 class="cms-modal-title">'+i.get("Common.Prompt")+"<\/h4>"+(r[n].header?r[n].header:"")+'<\/div ><div class="cms-modal-body">'+r[n].template+'<\/div><div class="cms-modal-footer">'+(r[n].footer?r[n].footer:"")+'<button class="btn btn-cancel" ng-show="\''+n+"'!=='alert' && '"+n+"'!=='alertError'\" ng-click=\"cancel()\">"+i.get("Common.Cancel")+'<\/button><div class="btn btn-contactService" ng-show="\''+n+'\'==\'alertError\'" line-chat-click="{{chatLink}}"><i class="fas fa-headphones"><\/i> <span>'+i.get("Common.ContactService")+'<\/span><\/div><button class="btn btn-confirm" ng-click="ok()">'+i.get("Common.Confirm")+"<\/button><\/div>";return{template:t,params:r[n].params}}function f(t,i,r,u,f,e,o){return n.open({template:i||"",controller:["modalMsg","modalParams","modalHeader","modalFooter","modalChatLink","$document","$scope","$modalInstance","$timeout",function(n,t,i,r,u,f,e,o,s){e.input={msg:""};e.msg=n;e.header=i;e.footer=r;e.chatLink=u;e.ok=function(){o.close(t.ok(e.input.msg));e.$destroy()};e.cancel=function(){o.close(t.cancel());e.$destroy()};o.opened.then(function(){s(function(){var n=angular.element(document.getElementById("cms-modal-input"));n.length>0&&n[0].focus()},100)});f.on("keydown",function(n){switch(n.keyCode){case 13:e.ok();break;case 27:e.cancel()}});e.$on("$destroy",function(){f.off("keydown")})}],resolve:{modalParams:function(){return r||{}},modalMsg:function(){return u||""},modalHeader:function(){return f||""},modalFooter:function(){return e||""},modalChatLink:function(){return o||"Live800Link"}},backdrop:"static",backdropClass:"custom-backdrop",keyboard:!1,windowClass:`custom-modal ${t}`})}function e(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}var r={alert:{template:'<div bind-html-compile="{{msg}}"><\/div>',header:'<span class="cms-modal-header-error">{{header}}.<\/span>',params:{ok:function(){return!0},cancel:function(){return!0}}},alertError:{template:'<div bind-html-compile="{{msg}}"><\/div>',header:'<span class="cms-modal-header-error">{{header}}<\/span>',footer:'<div class="cms-modal-footer-error">{{footer}}<\/div>',params:{ok:function(){return!0},cancel:function(){return!0}}},confirm:{template:'<div bind-html-compile="{{msg}}"><\/div>',params:{ok:function(){return!0},cancel:function(){return!1}}},prompt:{template:'{{msg}} <br/><input id="cms-modal-input" ng-model="input.msg" type="text">',params:{ok:function(n){return n},cancel:function(){return!1}}},promptPwd:{template:'{{msg}} <br/><input id="cms-modal-input" ng-model="input.msg" type="password">',params:{ok:function(n){return n},cancel:function(){return!1}}}};this.alert=function(n){var i=u("alert"),r=e("nohostname_ip");return f("alert",i.template,i.params,n,r).result.then(function(n){return t(function(){return n},400)})};this.alertError=function(n,i){var r=u("alertError"),o=e("nohostname_ip"),s=e("clientIp");return f("alertError",r.template,r.params,n,o,s,i).result.then(function(n){return t(function(){return n},400)})};this.confirm=function(n){var i=u("confirm");return f("confirm",i.template,i.params,n).result.then(function(n){return t(function(){return n},400)})};this.prompt=function(n){var i=u("prompt");return f("prompt",i.template,i.params,n).result.then(function(n){return t(function(){return n},400)})};this.promptPwd=function(n){var i=u("promptPwd");return f("promptPwd",i.template,i.params,n).result.then(function(n){return t(function(){return n},400)})}}return new r}]);shared.factory("FavoriteGameService",["$http",function(n){function t(){this.modifyFavorites=function(t,i){return n.post("/MemberCenter/ModifyFavoriteGame",{gameId:t,isAdd:i}).then(function(n){return n})};this.getFavorites=function(){return n.post("/MemberCenter/GetFavoriteGame",null).then(function(n){for(var r,t=n.data,i=0;i<t.length;i++)if(t[i].ButtonImagePath="https://cdn.fidlite.com/"+t[i].ButtonImagePath,t[i].ImagePlus.length>0)for(r=0;r<t[i].ImagePlus.length;r++)t[i].ImagePlus[r].ImageFilePath="https://cdn.fidlite.com/"+t[i].ImagePlus[r].ImageFilePath;return t})};this.addFavoritesToStorage=function(n){var t=localStorage.getItem("doAddFavorite")?JSON.parse(localStorage.getItem("doAddFavorite")):[];t.push(n.GId);localStorage.setItem("doAddFavorite",JSON.stringify(t))};this.addFavoritesFromStorage=function(){var n=localStorage.getItem("doAddFavorite")?JSON.parse(localStorage.getItem("doAddFavorite")):[];n.length>0&&this.modifyFavorites(n,!0).then(function(){localStorage.removeItem("doAddFavorite")})}}return new t}]);shared.factory("labelService",["labels","$parse",function(n,t){return{get:function(i){return t(i)(n)}}}]);shared.factory("SiteSettingService",["$http",function(n){function t(){var t,i,r;this.getSiteTitle=function(){return n.post("/Home/GetProductSetting",null).then(function(n){var t=n.data;return t.IsSuccess===!1?{}:{PortalSiteName:t.PortalSiteName||"",TitleName:t.TitleName||""}})};this.getLoginVerifyType=function(){return n.post("/Account/GetLoginCaptchaVerifyType",null).then(function(n){var t=n.data;return t.IsSuccess===!1?{}:t})};this.getRegisterVerifyType=function(){return n.post("/Account/GetRegisterCaptchaVerifyType",null).then(function(n){var t=n.data;return t.IsSuccess===!1?{}:t})};this.getSiteTitleSingleton=function(){return t=t||this.getSiteTitle()};this.getLoginVerifyTypeSingleton=function(){return i=i||this.getLoginVerifyType()};this.getRegisterVerifyTypeSingleton=function(){return r=r||this.getRegisterVerifyType()}}return new t}]);shared.factory("UserService",["$http","CustomModalService",function(n,t){function i(){this.getJwtTokens=function(){return n.post("/User/GetJwtToken",null).then(function(n){var i=n.data;return i.IsSuccess===!1?(t.alertError(i.ErrorMessage),null):i})}}return new i}]);shared.directive("bindHtmlCompile",["$compile",function(n){return{restrict:"A",scope:{},link:function(t,i,r){var u=r.bindHtmlCompile;u&&(i.html(u),n(i.contents())(t))}}}]);shared.directive("onErrorSrc",function(){return{restrict:"A",link:function(n,t,i){t.on("error",function(){i.src!==i.onErrorSrc&&i.$set("src",i.onErrorSrc)})}}});shared.directive("siteName",["SiteSettingService",function(n){return{restrict:"A",scope:{postfix:"@"},template:"{{content}}{{postfix ? ' - ' + postfix : ''}}",link:function(t,i,r){var u=angular.isDefined(r.isTitle);n.getSiteTitleSingleton().then(function(n){var i=n.TitleName,r=n.PortalSiteName;t.content=u?i:r})}}}])