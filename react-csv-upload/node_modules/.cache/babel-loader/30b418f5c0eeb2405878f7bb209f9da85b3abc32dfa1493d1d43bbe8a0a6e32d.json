{"ast":null,"code":"import _classCallCheck from \"C:/Users/Jun Rong/Documents/GitHub/IMDA-Domain-IP-Enrichment/react-csv-upload/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/Jun Rong/Documents/GitHub/IMDA-Domain-IP-Enrichment/react-csv-upload/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"C:/Users/Jun Rong/Documents/GitHub/IMDA-Domain-IP-Enrichment/react-csv-upload/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/Users/Jun Rong/Documents/GitHub/IMDA-Domain-IP-Enrichment/react-csv-upload/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nvar _jsxFileName = \"C:\\\\Users\\\\Jun Rong\\\\Documents\\\\GitHub\\\\IMDA-Domain-IP-Enrichment\\\\react-csv-upload\\\\src\\\\FileInput.tsx\";\nimport React, { Component, createRef } from \"react\";\nimport PapaParse from \"papaparse\";\nimport Button from \"@material-ui/core/Button\";\nimport FileDisplay from \"./FileDisplay\";\n// import { SelectedFile } from \"./SelectedFile\";\n\nimport { DateParts } from \"./helpers/classes\";\nimport { renameFile } from \"./helpers/functions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar FileInput = /*#__PURE__*/function (_Component) {\n  _inherits(FileInput, _Component);\n  var _super = _createSuper(FileInput);\n  function FileInput(props) {\n    var _this;\n    _classCallCheck(this, FileInput);\n    _this = _super.call(this, props);\n    _this.reader = new window.FileReader();\n    _this.fileDisplayElement = void 0;\n    _this.readFile = function (file) {\n      var encoding = \"utf-8\";\n      var currentFile = file;\n      var options = {};\n      _this.reader.onload = function (loadEvent) {\n        var content = loadEvent.target.result;\n        var parsedContent = typeof content === \"string\" ? PapaParse.parse(content, options) : null;\n        currentFile.content = content;\n        currentFile.parsedContent = parsedContent;\n        _this.setState({\n          selectedFile: currentFile\n        });\n      };\n      _this.reader.readAsText(file, encoding);\n    };\n    // TODO: handle cases where the file dialog is opened but no file selected\n    _this.onFileChange = function (fileChangeEvent) {\n      var selectedFile = fileChangeEvent.target.files[0];\n      _this.setState({\n        selectedFile: selectedFile\n      });\n      _this.readFile(selectedFile);\n      _this.fileDisplayElement.current.handleFileInputChange(selectedFile);\n      // i really wanted to put all the stuff to do with the actual file into its own class\n      // but i don't think i can make it work :(\n      // const testSelectedFile = new SelectedFile(\n      //   fileChangeEvent.target.files[0],\n      //   \"test\",\n      //   new window.FileReader()\n      // );\n      // console.log(\"testSelectedFile\", testSelectedFile);\n    };\n    _this.onFileClear = function () {\n      var selectedFile = null;\n      _this.setState({\n        selectedFile: selectedFile\n      });\n      _this.fileDisplayElement.current.handleFileInputChange(selectedFile);\n    };\n    _this.onFileUpload = function () {\n      var selectedFile = _this.state.selectedFile;\n      console.log(\"selected file to upload\", selectedFile);\n\n      // do whatever steps to upload the file\n      var uploadDateTime = new DateParts(new Date());\n      // console.log(\"uploadDateTime\", uploadDateTime);\n      var fileToUpload = new File([selectedFile.content], renameFile(selectedFile.name, \"mytestfile\", uploadDateTime), {\n        type: selectedFile.type,\n        lastModified: selectedFile.lastModified\n      });\n\n      // axios.post(\"api/uploadfile\", this.state.content);\n      console.log(\"fileToUpload\", fileToUpload);\n\n      // clear the input\n      _this.onFileClear();\n    };\n    _this.state = {\n      selectedFile: null\n    };\n    _this.fileDisplayElement = /*#__PURE__*/createRef();\n    return _this;\n  }\n  _createClass(FileInput, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state$selectedF;\n      // console.log(\"this.state on render (FileInput)\", this.state);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Upload File\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"100%\",\n            display: \"flex\",\n            justifyContent: \"space-evenly\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"file-input\",\n            type: \"file\",\n            accept: \".csv\" // \".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\n            ,\n            onChange: this.onFileChange,\n            style: {\n              display: \"none\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"file-input\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"contained\",\n              color: \"primary\",\n              component: \"span\",\n              children: \"Choose a file\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            component: \"span\",\n            onClick: this.onFileUpload,\n            disabled: !((_this$state$selectedF = this.state.selectedFile) !== null && _this$state$selectedF !== void 0 && _this$state$selectedF.content),\n            children: \"Upload\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            component: \"span\",\n            onClick: this.onFileClear,\n            disabled: !this.state.selectedFile,\n            children: \"Clear\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(FileDisplay, {\n          ref: this.fileDisplayElement\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n  return FileInput;\n}(Component);\nexport default FileInput;","map":{"version":3,"names":["React","Component","createRef","PapaParse","Button","FileDisplay","DateParts","renameFile","jsxDEV","_jsxDEV","FileInput","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","reader","window","FileReader","fileDisplayElement","readFile","file","encoding","currentFile","options","onload","loadEvent","content","target","result","parsedContent","parse","setState","selectedFile","readAsText","onFileChange","fileChangeEvent","files","current","handleFileInputChange","onFileClear","onFileUpload","state","console","log","uploadDateTime","Date","fileToUpload","File","name","type","lastModified","_createClass","key","value","render","_this$state$selectedF","style","textAlign","children","fileName","_jsxFileName","lineNumber","columnNumber","width","display","justifyContent","id","accept","onChange","htmlFor","variant","color","component","onClick","disabled","ref"],"sources":["C:/Users/Jun Rong/Documents/GitHub/IMDA-Domain-IP-Enrichment/react-csv-upload/src/FileInput.tsx"],"sourcesContent":["import React, { Component, ChangeEvent, createRef, RefObject } from \"react\";\r\nimport PapaParse from \"papaparse\";\r\nimport axios from \"axios\";\r\n\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nimport FileDisplay from \"./FileDisplay\";\r\n// import { SelectedFile } from \"./SelectedFile\";\r\nimport { ISelectedFile } from \"./helpers/interfaces\";\r\nimport { DateParts } from \"./helpers/classes\";\r\nimport { renameFile } from \"./helpers/functions\";\r\n\r\ninterface ComponentProps {}\r\ninterface ComponentState {\r\n  selectedFile: ISelectedFile;\r\n}\r\n\r\nclass FileInput extends Component<ComponentProps, ComponentState> {\r\n  reader: FileReader = new window.FileReader();\r\n  fileDisplayElement: RefObject<any>;\r\n  constructor(props: ComponentProps) {\r\n    super(props);\r\n    this.state = {\r\n      selectedFile: null\r\n    };\r\n    this.fileDisplayElement = createRef();\r\n  }\r\n  readFile = (file: ISelectedFile) => {\r\n    let encoding: string = \"utf-8\";\r\n    let currentFile: ISelectedFile = file;\r\n    let options = {};\r\n    this.reader.onload = (loadEvent: ProgressEvent<FileReader>) => {\r\n      const content = loadEvent.target.result;\r\n      const parsedContent =\r\n        typeof content === \"string\" ? PapaParse.parse(content, options) : null;\r\n      currentFile.content = content;\r\n      currentFile.parsedContent = parsedContent;\r\n      this.setState({\r\n        selectedFile: currentFile\r\n      });\r\n    };\r\n    this.reader.readAsText(file, encoding);\r\n  };\r\n  // TODO: handle cases where the file dialog is opened but no file selected\r\n  onFileChange = (fileChangeEvent: ChangeEvent<HTMLInputElement>) => {\r\n    const selectedFile: ISelectedFile = fileChangeEvent.target.files[0];\r\n    this.setState({ selectedFile });\r\n    this.readFile(selectedFile);\r\n    this.fileDisplayElement.current.handleFileInputChange(selectedFile);\r\n    // i really wanted to put all the stuff to do with the actual file into its own class\r\n    // but i don't think i can make it work :(\r\n    // const testSelectedFile = new SelectedFile(\r\n    //   fileChangeEvent.target.files[0],\r\n    //   \"test\",\r\n    //   new window.FileReader()\r\n    // );\r\n    // console.log(\"testSelectedFile\", testSelectedFile);\r\n  };\r\n  onFileClear = () => {\r\n    const selectedFile = null;\r\n    this.setState({ selectedFile });\r\n    this.fileDisplayElement.current.handleFileInputChange(selectedFile);\r\n  };\r\n  onFileUpload = () => {\r\n    const selectedFile = this.state.selectedFile;\r\n    console.log(\"selected file to upload\", selectedFile);\r\n\r\n    // do whatever steps to upload the file\r\n    const uploadDateTime = new DateParts(new Date());\r\n    // console.log(\"uploadDateTime\", uploadDateTime);\r\n    const fileToUpload = new File(\r\n      [selectedFile.content],\r\n      renameFile(selectedFile.name, \"mytestfile\", uploadDateTime),\r\n      { type: selectedFile.type, lastModified: selectedFile.lastModified }\r\n    );\r\n\r\n    // axios.post(\"api/uploadfile\", this.state.content);\r\n    console.log(\"fileToUpload\", fileToUpload);\r\n\r\n    // clear the input\r\n    this.onFileClear();\r\n  };\r\n\r\n  render() {\r\n    // console.log(\"this.state on render (FileInput)\", this.state);\r\n    return (\r\n      <div\r\n        style={{\r\n          textAlign: \"center\"\r\n        }}\r\n      >\r\n        <h1>Upload File</h1>\r\n        <div\r\n          style={{\r\n            width: \"100%\",\r\n            display: \"flex\",\r\n            justifyContent: \"space-evenly\"\r\n          }}\r\n        >\r\n          <input\r\n            id=\"file-input\"\r\n            type=\"file\"\r\n            accept=\".csv\" // \".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\r\n            onChange={this.onFileChange}\r\n            style={{\r\n              display: \"none\"\r\n            }}\r\n          />\r\n          <label htmlFor=\"file-input\">\r\n            <Button variant=\"contained\" color=\"primary\" component=\"span\">\r\n              Choose a file\r\n            </Button>\r\n          </label>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            component=\"span\"\r\n            onClick={this.onFileUpload}\r\n            disabled={!this.state.selectedFile?.content}\r\n          >\r\n            Upload\r\n          </Button>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            component=\"span\"\r\n            onClick={this.onFileClear}\r\n            disabled={!this.state.selectedFile}\r\n          >\r\n            Clear\r\n          </Button>\r\n        </div>\r\n        <FileDisplay ref={this.fileDisplayElement} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default FileInput;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}